<html>
    <head>
        <link rel="stylesheet" href="node_modules/materialize-css/dist/css/materialize.min.css">
        <link rel="stylesheet" href="assets/material-icons/material-icons.css">

        <style>
            .collection {
                border: 1px solid #9b9b9b;
            }

            .collection .collection-item {
                background-color: #4c4c4c;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <br/>
        <div class="container">
            <div class="row" style="color:#d2d2d2;">
                <div class="col s3">
                    <img src="assets/images/logo-x256.png" class="responsive-img">
                </div>
                <div class="col s9">
                    <h4>Hi!</h4>
                    <p class="flow-text">
                        Welcome to the <strong>PluginBlueprint</strong> Editor!
                    </p>
                </div>
            </div>
            <br/>
            <br/>
            <div class="row">
                <button class="btn createNewProject"><i class="material-icons left">add</i> Create new Project</button>
                <button class="btn" id="openProject"><i class="material-icons left">folder_open</i> Open Project</button>
            </div>
            <div class="row" id="recentProjectRow">
                <h5>Recent Projects <a href="#" class="createNewProject right-align" style="color:#d2d2d2;"><i class="material-icons right">add</i></a></h5>
                <ul class="collection" id="recentProjects">
                    <!-- Dynamic -->
                </ul>
            </div>
        </div>

        <script>
            const {ipcRenderer} = require("electron");
            const {dialog, Menu, getCurrentWindow} = require("electron").remote;
            const prompt = require("electron-prompt");
            const $ = require("jquery");
            const Sentry = require("@sentry/electron");


            getCurrentWindow().setMenu(Menu.buildFromTemplate([
                {
                    label: "File",
                    submenu: [
                        {
                            label: "New", role: "new", click: () => {
                                ipcRenderer.send("showCreateNewProject");
                            }
                        },
                        {
                            label: "Open", role: "open", click: () => {
                                ipcRenderer.send("showOpenProject");
                            }
                        },
                        {
                            type: "separator"
                        },
                        {
                            role: "toggledevtools"
                        },
                    ]
                }
            ]));

            $(document).ready(function () {
                console.log("" +
                    "PluginBlueprint\n" +
                    "Copyright (c) 2018, Haylee SchÃ¤fer\n" +
                    "All rights reserved.\n");

                Sentry.init({dsn: 'https://6d56f92bc4f84e44b66950ed04e92704@sentry.io/1309246'});
            });

            ipcRenderer.send("getRecentProjects");

            $(".createNewProject").click(() => {
                ipcRenderer.send("showCreateNewProject");
            })

            $("#openProject").click(() => {
                ipcRenderer.send("showOpenProject");
            })

            ipcRenderer.on("recentProjects", function (event, arg) {
                for (let i = 0; i < arg.length; i++) {
                    let item = $('<li class="collection-item">' + arg[i] + '</li>');
                    item.click(() => {
                        ipcRenderer.send("openProject", arg[i]);
                    });
                    item.appendTo($("#recentProjects"));
                }
                if (arg.length === 0) {
                    $("#recentProjectRow").hide();
                }
            });
        </script>
    </body>
</html>